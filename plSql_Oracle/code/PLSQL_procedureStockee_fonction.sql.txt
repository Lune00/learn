--Procédures stockées: on cree une procédure qui sera stockée comme une table dans la
-- bdd. 

CREATE OR REPLACE PROCEDURE p_emp(v_num emp.deptno%type) IS
   CURSOR c_emp IS SELECT * FROM emp where deptno=v_num;
   BEGIN
   FOR i IN c_emp LOOP
    DBMS_OUTPUT.put_line(i.ename);
   END LOOP;
END;
/

--On execute la procédure
EXECUTE p_emp(20);


-- Declaration d'une fonction
-- Un RETURN pour le type de retour, un RETURN pour la valeur
CREATE OR REPLACE FUNCTION carre(a INTEGER)
    RETURN INTEGER IS
BEGIN
    RETURN a * a ;
END;

SELECT carre(120) FROM dual;

--Exercice : ecrire une fonction argument numero employe , renvoie son nom, son salaire

CREATE OR REPLACE FUNCTION getEmployeeSalary(numEmp emp.empno%type) 
     RETURN emp.sal%type   
    IS 
    v_sal emp.sal%type;
    BEGIN
    SELECT sal INTO v_sal FROM emp WHERE emp.empno = numEmp;
    RETURN v_sal;
END;
/

SELECT getEmployeeSalary(7499) FROM dual;